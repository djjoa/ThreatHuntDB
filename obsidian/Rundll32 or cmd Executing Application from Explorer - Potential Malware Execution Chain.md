---
id: 3bc6e8ef-9e08-4626-89e9-fda87866cc82
name: Rundll32 or cmd Executing Application from Explorer - Potential Malware Execution Chain
description: |
  'Identifies when rundll32 or cmd.exe is utilized to launch a malicious DLL or executable from explorer.exe. Indicative of a cmd window or LNK file executing a program or malware due to a user clicking on a file.'
requiredDataConnectors:
  - connectorId: SecurityEvent
    dataTypes:
      - SecurityEvent
tactics:
  - Execution
relevantTechniques:
  - T1204.002
query: "```kusto\nSecurityEvent\n| where ParentProcessName has \"explorer.exe\" \n| where Process has_any (\n  \"wscript.exe\",\n  \"rundll32.exe\",\n  \"explorer.exe\",\n  \"cmd.exe\"\n  )\n| where (CommandLine has_any (\n  \"explorer\",\n  \"rundll32\"\n  ) and CommandLine has_any (\n  \".dll,\",\n  \".dll \"\n  )) or (CommandLine has \"cmd.exe\" and CommandLine matches regex \"\\\\/[Cc] +[Ss][Tt][Aa][Rr][Tt].*\\\\.exe\")\n| project TimeGenerated, Computer, tostring(EventID), ParentProcessName, NewProcessName, CommandLine, SubjectUserName, SourceComputerId, processID=tolong(NewProcessId), parentProcessID=tolong(ProcessId), EventData| order by TimeGenerated\n```"
version: 1.0.0
---

