---
id: c8796d76-9a84-4cc8-91b5-d01f882869d4
name: Gootkit-malware
description: |
  This query was originally published on Twitter, by @MsftSecIntel.
  Gootkit is malware that started life as a banking trojan, and has since extended its capabilities to allow for a variety of malicious activities.
  The query helps find events related to Gootkit downloads and command-and-control behavior.
  Reference - https://twitter.com/MsftSecIntel
requiredDataConnectors:
  - connectorId: MicrosoftThreatProtection
    dataTypes:
      - AlertInfo
      - AlertEvidence
      - DeviceNetworkEvents
tactics:
  - Command and control
query: "```kusto\nAlertInfo | where Title =~ \"Suspected delivery of Gootkit malware\"\n// Below section is to surface active follow-on Command and Control as a result of the above behavior. Comment out the below joins to see\n// only file create events where the malware may be present but has not yet been executed.\n////\n// Get alert evidence\n| join AlertEvidence on $left.AlertId == $right.AlertId\n// Look for C2\n| join DeviceNetworkEvents  on $left.DeviceId == $right.DeviceId\n| where InitiatingProcessFileName =~ \"wscript.exe\" and InitiatingProcessCommandLine has \".zip\" and InitiatingProcessCommandLine has \".js\"\n| summarize by RemoteUrl, RemoteIP , DeviceId, InitiatingProcessCommandLine, Timestamp, \nInitiatingProcessFileName, AlertId, Title, AccountName\n```"
---

