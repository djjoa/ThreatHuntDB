name: Update ThreatHuntDB with Splunk detections
on: workflow_dispatch
jobs:
  update-splunk-detections:
    runs-on: ubuntu-latest
    permissions: 
      actions: write
    steps:
      - name: Checkout 🛎️
        uses: actions/checkout@v4 # check out the the ThreatHuntDB repo 
        with:
          token: ${{ secrets.TOKEN }}

        
      #- shell: bash # query Splunk public API to get latest detections 
      - name: Get Splunk detections with curl
        run: |
          curl -o ./data/splunk-detections.json https://content.splunkresearch.com/detections 
      - name: Add and commit changes
        run: |
          git config --global user.email "<github email>" # change me 
          git config --global user.name "<github name>" # change me 

          git add ./data/splunk-detections.json 
          git commit -m "Updated ThreatHuntDB with latest Splunk detections and hunts."
          git push 

          



